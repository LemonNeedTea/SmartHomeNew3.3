{"version":3,"sources":["../../src/pages/device-setting/cemera/cemera.ts","../../src/pages/device-setting/cemera/cemera.module.ts"],"names":[],"mappings":"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","file":"46.js","sourcesContent":["import { Component, ViewChild } from '@angular/core';\nimport { IonicPage, NavController, NavParams, AlertController } from 'ionic-angular';\n\n/**\n * Generated class for the CemeraPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-cemera',\n  templateUrl: 'cemera.html',\n})\nexport class CemeraPage {\n  @ViewChild(\"cvs1\") cvs1;\n  @ViewChild(\"ionContent\") ionContent;\n\n\n\n\n  id: number;\n  name: string;\n  _context: any;\n  _cvsWidth: number;\n  _cvsHeight: number;\n  ws: any;\n  _lastMsg = \"\";\n  _lastColor = null;\n\n  constructor(public navCtrl: NavController, public navParams: NavParams,\n    private alertCtrl: AlertController) {\n\n\n\n  }\n\n  ionViewDidLoad() {\n    let htmlWidth = document.documentElement.clientWidth || document.body.clientWidth;\n    let htmlHeight = document.documentElement.clientHeight || document.body.clientHeight;\n\n    this._cvsWidth = htmlWidth;\n\n    this._cvsHeight = htmlWidth * 3 / 4;\n\n    this.cvs1.nativeElement.width = this._cvsWidth;\n    this.cvs1.nativeElement.height = this._cvsHeight;\n\n    document.getElementById(\"divFresh\").style.height = this._cvsHeight + \"px\";\n\n    document.getElementById(\"divSetting\").style.height = (htmlHeight - this._cvsHeight) + \"px\";\n\n    this._context = this.cvs1.nativeElement.getContext('2d');\n    this.id = this.navParams.get(\"id\");\n    this.name = this.navParams.get(\"name\");\n\n    this.startWebSocket();\n  }\n  startWebSocket() {\n    if (this.ws) {\n      this.ws.close();\n      this.ws = null;\n    }\n    this.ws = new WebSocket(\"ws://192.168.4.113:9999\");\n    this.ws.onmessage = (e) => {\n      this.onMessage(e);\n    };\n    this.ws.onopen = () => {\n      this._showPaint(\"正在连接服务器...\");\n    }\n\n    this.ws.onerror = (event) => {\n      this._showPaint(\"连接服务器失败！\");\n    };\n    this.ws.onclose = (event) => {\n      this._showPaint(\"连接已断开！\", \"#FF0000\");\n    };\n  }\n  onMessage(event) {\n    let r = JSON.parse(event.data);\n\n    if (r.State == 3) {\n      // _close();\n      // _showPaint(\"链接中\", \"#FF0000\");\n      return;\n    }\n    if (r.Data) {\n      let imgObj = new Image();\n      imgObj.src = r.Data;\n      let that = this;\n      imgObj.onload = function () {\n\n        that._context.drawImage(this, 0, 0, that._cvsWidth, that._cvsHeight);\n      }\n    }\n  }\n\n  _showPaint(msg, color = \"#fff\") {\n\n    if (msg) {\n      this._lastMsg = msg;\n      this._lastColor = color ? color : '#0000FF';\n\n      this._context.fillStyle = 'black';\n      this._context.fillRect(0, 0, this._cvsWidth, this._cvsHeight);\n      this._context.fillStyle = this._lastColor;\n      this._context.textAlign = \"center\";\n      this._context.font = \"bold 12px '宋体'\";\n      this._context.fillText(msg, this._cvsWidth / 2, this._cvsHeight / 2);\n    } else {\n      this._lastMsg = null;\n      this._lastColor = null;\n    }\n  }\n\n  ionViewDidLeave() {\n    this.ws.close();\n  }\n  setCemera(type, data) {\n    let params = {\n      Type: type,\n      Data: data\n    }\n\n    this.sendMessage(params);\n  }\n  sendMessage(message: any) {\n    console.log(message);\n\n    this.ws.send(JSON.stringify(message));\n  }\n\n  presentPrompt() {\n    let alert = this.alertCtrl.create({\n      title: '预置点设置',\n      inputs: [\n        {\n          name: 'num',\n          placeholder: '序号',\n          type: 'number'\n        }\n      ],\n      buttons: [\n        {\n          text: '取消',\n          role: 'cancel',\n          handler: data => {\n            console.log('Cancel clicked');\n          }\n        },\n        {\n          text: '确定',\n          handler: data => {\n            if (data.num) {\n              this.setCemera(8, data.num * 1);\n              // logged in!\n            } else {\n              // invalid login\n              return false;\n            }\n          }\n        }\n      ]\n    });\n    alert.present();\n  }\n\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/device-setting/cemera/cemera.ts","import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { CemeraPage } from './cemera';\n\n@NgModule({\n  declarations: [\n    CemeraPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(CemeraPage),\n  ],\n})\nexport class CemeraPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/device-setting/cemera/cemera.module.ts"],"sourceRoot":""}